{"name":"Sizedog","tagline":"Automatic Resizing of LVM and File Systems in OpenSUSE","body":"###Abstract:\r\n\r\nTo build a standalone Application/tool called Size Dog that can perform Automatic resizing of File system and Logical Volumes. This Application/Tool can be called by the package manager if the size of the package to be installed exceeds the size available on the logical volume and increase the size of the logical volume if there is unallocated space in the logical volume group.\r\n\r\n\r\n###Detailed Description:\r\nopenSUSE currently provides good support for creating LVM volumes and installing the OS on these volumes. However, if the file system becomes full, the user/administrator has to increase the volume size and contained file system capacity manually.\r\n\r\n ##Goal of the project:\r\nTo implement automatic resizing of LVM volumes and contained file systems. This resizing would be triggered e.g. by the package manager before installing the packages, if the free space drops before certain threshold etc. The installer calls the Size Dog tool to compute the necessary space needed for installing the selected set of packages and allocate the LVM volumes 'just big enough' for the installation.\r\nThis tool will also have it's own config file where an admin/user can define per partition e.g. the desired minimal free space; whether automatic resize is ok or whether low space should just be reported so the admin does it manually using the CLI. The tool automatically checks the config file and state of the Logical volume and performs the required action automatically.\r\n\r\n\r\n\r\n###Background:\r\nLogical Volume Manager or LVM provides a method of allocating space on mass-storage devices that is more flexible than conventional partitioning schemes. With LVM, a hard drive or set of hard drives is allocated to one or more Physical Volumes.Physical volumes can be placed on other block devices which might span two or more disks.\r\nCurrently if the space needed for installation of package is more than the free space in volume then the user has to either delete and clear some space or increase the size of volume manually. With this tool resizing of LVM can be done automatically.\r\nThe Idea has been requested by the assigned mentor of the project Dinar Valeev in openFATE:\r\nhttps://features.opensuse.org/309704\r\n\r\n###Use Cases:\r\n\r\n##Case 1:\r\na) User wants at least 2 GB to be always free as work space in /usr\r\nb) user runs re-sizer after package installation which then resizes the volume to have at least 2 GB free.\r\n \r\n##Case 2:\r\na)  Backup utility demands ~1 GB of free space for backing up of important documents, but the volume   doesn't have that much free space.\r\nb)  Backup utility calls resizer with volume and resize amount as requisites, and the resizer extend the volume to have at least 1 GB of free space.\r\n\r\n\r\n##Case 3: System Administrator can run this tool to automatically increase or decrease the size of volume allotted to each user if some free space is always needed by a user in his/her volume.\r\n\r\n##Case 4: ( To be hooked to LibZypp once the tool becomes hard and reliable )\r\na)  User installs a package, but that package demands X MB installation space.\r\nb)  Package manager runs resizer which resizes the volumes by the appropriate amount, and then proceed towards installing the software.\r\n\r\n\r\n###Benefits:\r\n\r\na) The user doesn't have to worry about disk space getting low while installation of packages, he/she don't  have to delete files to clear disk space, The tool will take care of that and also the disk space will be used in a better way by allocating the required space requested by the user.\r\n\r\nb) The tool will also maintain the free space needed in each volume as defined by the user in config file.\r\n\r\nc) The LVM resizing will be more user friendly and hassle free.\r\n\r\nd) This tool will not only help openSUSE but can be used by other Package management tools of different Linux distributions.\r\n\r\n\r\n###Caveats:\r\na) This tool is only implemented for LVM volume groups, so it will not work for non-LVM based file  systems.\r\nb) File systems that are supported are ext3, ext4. xfs and btrfs only.\r\nc) Online shrinking not possible in all cases, file system has to be unmounted before shrinking.\r\n\r\n###Technical Details:\r\n\r\nThis project idea will be implemented using Python. The tool will use The python bindings of LibLVM and lvm2py API.\r\npython liblvm bindings: https://github.com/akifkhan/python-lvm \r\nlvm2py is a ctypes based binding for lvm's liblvmapp api:  https://github.com/akifkhan/lvm2py\r\n\r\n\r\nTool will have its own config file stored in /etc the config file will contain details such as:\r\na) Automatic resizing enabled/disabled (Default: Disabled)\r\nb) System determined resizing/User configured resizing (Default: System configured resizing)\r\nIf User configured resizing is enabled, the following options will be available to change:\r\n\r\n1) File systems supported: (Default: All LVM fs except /home)\r\n\r\n2) File Systems not supported: (Default: None)\r\n\r\n3) Free space needed: For each filesystem mentioned, the amount of free space needed, either in MBs / GBs or by % of total volume size. (Default: 5%)\r\n \r\nSo, it is possible to configure the resizer to keep different amount of free space for various volumes, e.g. 2G for /var and 10% for /usr, independent of each other.\r\n\r\nI have created some sample code for the tool here: https://github.com/akifkhan/SizeDog/blob/master/sample.py\r\n\r\n\r\n###Working of LVM Resizing:\r\n\r\n1) There are logical volumes within Volume Group (/usr, /tmp)\r\n2) Volume Group have free Physical Extents.\r\n3) Logical volume have no free space for package install\r\n4) Install package/packages which requires 12Mb in /tmp, 40Mb in /usr and 16Mb in /var\r\n5) Size Dog will extend logical volumes and file systems /tmp by 3 Logical Extents /var by 10 Logical Extents and var by 4 Logical Extents.\r\n\r\n\r\n###Future Goals:\r\nThe tool can be useful for all linux distributions that support LVM, so the tool has to be made compatible with most Linux distros and hooking the tool to various package managers. \r\nWould also work for better integration of this tool in openSUSE operating system. Above all, I would try to keep myself actively associated with the activities in the community. The openSUSE community will gain another developer who will push it to newer heights.\r\n\r\n\r\n\r\n##Original project idea: http://en.opensuse.org/openSUSE:GSOC_ideas#Automatic_resizing_of_LVM_volumes_and_filesystems\r\n\r\n###REFERENCES:\r\n[1] http://tldp.org/HOWTO/LVM-HOWTO/\r\n[2] http://www.debian-administration.org/articles/410\r\n[3] http://en.wikipedia.org/wiki/Logical_Volume_Manager_(Linux)\r\n         Name:  Akif Khan Yusufzai   Email : akif500@gmail.com   IRC (Freenode) : akif500\r\n                     www.github.com/akifkhan     www.twitter.com/thisisakif","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}